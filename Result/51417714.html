<meta charset="utf-8"><div id="article_content" class="article_content">

<div style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">
<div id="cnblogs_post_body" style="word-wrap:break-word">
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　<span style="word-wrap:break-word">一、json_encode()</span></p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　该函数主要用来将数组和对象，转换为json&#26684;式。先看一个数组转换的例子：</p>
<blockquote style="word-wrap:break-word">
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
$arr = array ('a'=&gt;1,'b'=&gt;2,'c'=&gt;3,'d'=&gt;4,'e'=&gt;5);</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
echo json_encode($arr);</p>
</blockquote>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　结果为</p>
<blockquote style="word-wrap:break-word">
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
{&quot;a&quot;:1,&quot;b&quot;:2,&quot;c&quot;:3,&quot;d&quot;:4,&quot;e&quot;:5}</p>
</blockquote>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　再看一个对象转换的例子：</p>
<blockquote style="word-wrap:break-word">
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
$obj-&gt;body = 'another post';</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
$obj-&gt;id = 21;</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
$obj-&gt;approved = true;</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
$obj-&gt;favorite_count = 1;</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
$obj-&gt;status = NULL;</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
echo json_encode($obj);</p>
</blockquote>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　结果为</p>
<blockquote style="word-wrap:break-word">
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
{<br style="word-wrap:break-word">
　　　　&quot;body&quot;:&quot;another post&quot;,</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
&quot;id&quot;:21,</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
&quot;approved&quot;:true,</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
&quot;favorite_count&quot;:1,</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
&quot;status&quot;:null<br style="word-wrap:break-word">
　　}</p>
</blockquote>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　由于json只接受utf-8编码的字符，所以json_encode()的参数必须是utf-8编码，否则会得到空字符或者null。当中文使用GB2312编码，或者外文使用ISO-8859-1编码的时候，这一点要特别注意。</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　<span style="word-wrap:break-word">二、索引数组和关联数组</span></p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　PHP支持两种数组，一种是只保存&quot;&#20540;&quot;（value）的索引数组（indexed array），另一种是保存&quot;名&#20540;对&quot;（name/value）的关联数组（associative array）。</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　由于javascript不支持关联数组，所以json_encode()只将索引数组（indexed array）转为数组&#26684;式，而将关联数组（associative array）转为对象&#26684;式。</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　比如，现在有一个索引数组</p>
<blockquote style="word-wrap:break-word">
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
$arr = Array('one'， 'two'， 'three');</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
echo json_encode($arr);</p>
</blockquote>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　结果为：</p>
<blockquote style="word-wrap:break-word">
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
[&quot;one&quot;，&quot;two&quot;，&quot;three&quot;]</p>
</blockquote>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　如果将它改为关联数组：</p>
<blockquote style="word-wrap:break-word">
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
$arr = Array('1'=&gt;'one'， '2'=&gt;'two'， '3'=&gt;'three');</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
echo json_encode($arr);</p>
</blockquote>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　结果就变了：</p>
<blockquote style="word-wrap:break-word">
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
{&quot;1&quot;:&quot;one&quot;，&quot;2&quot;:&quot;two&quot;，&quot;3&quot;:&quot;three&quot;}</p>
</blockquote>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　注意，数据&#26684;式从&quot;[]&quot;（数组）变成了&quot;{}&quot;（对象）。</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　如果你需要将&quot;索引数组&quot;强制转化成&quot;对象&quot;，可以这样写</p>
<blockquote style="word-wrap:break-word">
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
json_encode( (object)$arr );</p>
</blockquote>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　或者</p>
<blockquote style="word-wrap:break-word">
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
json_encode ( $arr, JSON_FORCE_OBJECT );</p>
</blockquote>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　<span style="word-wrap:break-word">三、类（class）的转换</span></p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　下面是一个PHP的类：</p>
<blockquote style="word-wrap:break-word">
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
class Foo {</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
const ERROR_CODE = '404';</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
public $public_ex = 'this is public';</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
private $private_ex = 'this is private!';</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
protected $protected_ex = 'this should be protected';</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
public function getErrorCode() {</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
return self::ERROR_CODE;</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
}</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
}</p>
</blockquote>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　现在，对这个类的实例进行json转换：</p>
<blockquote style="word-wrap:break-word">
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
$foo = new Foo;</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
$foo_json = json_encode($foo);</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
echo $foo_json;</p>
</blockquote>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　输出结果是</p>
<blockquote style="word-wrap:break-word">
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
{&quot;public_ex&quot;:&quot;this is public&quot;}</p>
</blockquote>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　可以看到，除了公开变量（public），其他东西（常量、私有变量、方法等等）都遗失了。</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　<span style="word-wrap:break-word">四、json_decode()</span></p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　该函数用于将json文本转换为相应的PHP数据结构。下面是一个例子：</p>
<blockquote style="word-wrap:break-word">
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
$json = '{&quot;foo&quot;: 12345}';</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
$obj = json_decode($json);</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
print $obj-&gt;{'foo'}; // 12345</p>
</blockquote>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　通常情况下，json_decode()总是返回一个PHP对象，而不是数组。比如：</p>
<blockquote style="word-wrap:break-word">
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
$json = '{&quot;a&quot;:1,&quot;b&quot;:2,&quot;c&quot;:3,&quot;d&quot;:4,&quot;e&quot;:5}';</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
var_dump(json_decode($json));</p>
</blockquote>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　结果就是生成一个PHP对象：</p>
<blockquote style="word-wrap:break-word">
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
object(stdClass)#1 (5) {</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
[&quot;a&quot;] =&gt; int(1)<br style="word-wrap:break-word">
　　　　[&quot;b&quot;] =&gt; int(2)<br style="word-wrap:break-word">
　　　　[&quot;c&quot;] =&gt; int(3)<br style="word-wrap:break-word">
　　　　[&quot;d&quot;] =&gt; int(4)<br style="word-wrap:break-word">
　　　　[&quot;e&quot;] =&gt; int(5)</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
}</p>
</blockquote>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　如果想要强制生成PHP关联数组，json_decode()需要加一个参数true：</p>
<blockquote style="word-wrap:break-word">
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
$json = '{&quot;a&quot;:1,&quot;b&quot;:2,&quot;c&quot;:3,&quot;d&quot;:4,&quot;e&quot;:5}';</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
var_dump(json_decode($json),true);</p>
</blockquote>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　结果就生成了一个关联数组：</p>
<blockquote style="word-wrap:break-word">
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
array(5) {</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
[&quot;a&quot;] =&gt; int(1)<br style="word-wrap:break-word">
　　 　　[&quot;b&quot;] =&gt; int(2)<br style="word-wrap:break-word">
　　 　　[&quot;c&quot;] =&gt; int(3)<br style="word-wrap:break-word">
　　 　　[&quot;d&quot;] =&gt; int(4)<br style="word-wrap:break-word">
　　 　　[&quot;e&quot;] =&gt; int(5)</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
}</p>
</blockquote>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　<span style="word-wrap:break-word">五、json_decode()的常见错误</span></p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　下面三种json写法都是错的，你能看出错在哪里吗？</p>
<blockquote style="word-wrap:break-word">
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
$bad_json = &quot;{ 'bar': 'baz' }&quot;;</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
$bad_json = '{ bar: &quot;baz&quot; }';</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
$bad_json = '{ &quot;bar&quot;: &quot;baz&quot;， }';</p>
</blockquote>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　对这三个字符串执行json_decode()都将返回null，并且报错。</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　第一个的错误是，json的分隔符（delimiter）只允许使用双引号，不能使用单引号。第二个的错误是，json名&#20540;对的&quot;名&quot;（冒号左边的部分），任何情况下都必须使用双引号。第三个的错误是，最后一个&#20540;之后不能添加逗号（trailing comma）。</p>
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
　　另外，json只能用来表示对象（object）和数组（array），如果对一个字符串或数&#20540;使用json_decode()，将会返回null。</p>
<blockquote style="word-wrap:break-word">
<p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px">
var_dump(json_decode(&quot;Hello World&quot;)); //null</p>
</blockquote>
</div>
</div>
<div style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">
php json操作的实例</div>
<div style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">
&nbsp;</div>
<div style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">
class A{<br style="word-wrap:break-word">
&nbsp;public $id;<br style="word-wrap:break-word">
&nbsp;public $name;<br style="word-wrap:break-word">
&nbsp;public function getName(){<br style="word-wrap:break-word">
&nbsp;&nbsp;<br style="word-wrap:break-word">
&nbsp;}<br style="word-wrap:break-word">
}</div>
<div style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">
$a=new A();<br style="word-wrap:break-word">
$a-&gt;id='123';<br style="word-wrap:break-word">
$a-&gt;name='aaa';</div>
<div style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">
$b=new A();<br style="word-wrap:break-word">
$b-&gt;id='123';<br style="word-wrap:break-word">
$b-&gt;name='bbb';</div>
<div style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">
$c=array('a'=&gt;$a,'b'=&gt;$b);<br style="word-wrap:break-word">
$josn=json_encode($c);<br style="word-wrap:break-word">
$obj=json_decode($josn);<br style="word-wrap:break-word">
$key='ccc';<br style="word-wrap:break-word">
//添加一个新的对象<br style="word-wrap:break-word">
&nbsp;$obj-&gt;$key=$b;<br style="word-wrap:break-word">
var_dump($obj);</div>
<div style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">
//echo $josn;<br style="word-wrap:break-word">
?&gt;</div>
   
</div>




<!-- Baidu Button BEGIN -->




<div class="bdsharebuttonbox tracking-ad" style="float: right;" data-mod="popu_172">
<a href="#" class="bds_more" data-cmd="more" style="background-position:0 0 !important; background-image: url(http://bdimg.share.baidu.com/static/api/img/share/icons_0_16.png?v=d754dcc0.png) !important"></a>
<a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"  style="background-position:0 -52px !important"></a>
<a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"style="background-position:0 -104px !important"></a>
<a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博"style="background-position:0 -260px !important"></a>
<a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网"style="background-position:0 -208px !important"></a>
<a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"style="background-position:0 -1612px !important" ></a>
</div>
<script>window._bd_share_config = { "common": { "bdSnsKey": {}, "bdText": "", "bdMini": "1", "bdMiniList": false, "bdPic": "", "bdStyle": "0", "bdSize": "16" }, "share": {} }; with (document) 0[(getElementsByTagName('head')[0] || body).appendChild(createElement('script')).src = 'http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion=' + ~(-new Date() / 36e5)];</script>
<!-- Baidu Button END -->

   <link rel="stylesheet" href="http://static.blog.csdn.net/css/blog_detail.css" />

    
<!--172.16.140.14-->

<!-- Baidu Button BEGIN -->
<script type="text/javascript" id="bdshare_js" data="type=tools&amp;uid=1536434" ></script>
<script type="text/javascript" id="bdshell_js"></script>
<script type="text/javascript">
    document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000)
</script>
<!-- B